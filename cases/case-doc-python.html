<div id="case-doc-python" class="case-card case-content active">
    <h2><i class="fab fa-python"></i> [문서 처리] Python 활용 교재 PDF 문항 자동 추출</h2>
    <p class="lead"><span class="badge me-2">작성자: 디지털서비스팀 강귀현</span><span class="badge">부문: 문서/데이터 처리 자동화</span></p>

    <div class="alert alert-secondary p-3 mb-4">
        <ul class="list-unstyled mb-0" style="font-size: 0.95rem;">
            <li class="mb-2">1️⃣ <strong>구현 사례 :</strong> [문서 처리] Python 활용 교재 PDF 문항 자동 추출</li>
            <li class="mb-2">2️⃣ <strong>활용 부서 :</strong> 디지털서비스팀</li>
            <li class="mb-2">3️⃣ <strong>구현 도구 :</strong> Python (ChatGPT 활용)</li>
            <li class="mb-2">4️⃣ <strong>활용 기술 :</strong> PDF 이미지 변환, 이미지 분할/병합, 자동 저장</li>
        </ul>
    </div>

    <aside class="alert alert-light mb-4">
        <h5 class="alert-heading mb-0" style="font-size: 1rem;">📌 <strong>PDF 이미지 변환이란?</strong></h5>
        <hr>
        <p class="mb-0 small">
            PDF 문서의 각 페이지를 PNG나 JPG 같은 '이미지' 파일로 바꾸는 기술이에요. 텍스트가 아닌 그림으로 만들어, Python이 이미지를 자르거나 붙이는 등의 작업을 할 수 있게 해줍니다.
        </p>
    </aside>

    <aside class="alert alert-light mb-4">
        <h5 class="alert-heading mb-3"><i class="fas fa-podcast me-2"></i> 구현사례 소개 팟캐스트</h5>
        <hr>
        <p class="mb-2">사례를 살펴보기 전, 팟캐스트를 청취해 보세요.</p>
        
        <audio controls class="w-100 mb-3" style="min-height: 50px;">
            <source src="assets/audio/python-case1.m4a" type="audio/mp4">
            Your browser does not support the audio element.
        </audio>
        
        <ul class="list-unstyled small text-muted mb-0">
            <li class="mb-2">• 본 팟캐스트는 NotebookLM으로 제작되었습니다.</li>
            <li>
                <a href="https://notebooklm.google.com/" target="_blank" class="text-decoration-none">
                    <div class="bg-white border rounded p-2 px-3" style="font-family: 'Courier New', Courier, monospace; font-size: 0.9rem;">
                        notebooklm.google.com
                        <br>
                        <span class="text-primary">https://notebooklm.google.com/</span>
                    </div>
                </a>
            </li>
        </ul>
    </aside>

    <h3>1. 성과요약</h3>
    <p>Python 자동화를 통해 <strong>연간 120시간 소요되던 작업을 연간 3~4시간으로 단축</strong>시켜, 약 116시간의 업무 시간을 절약하는 성과를 달성했습니다.</p>
    
    <div class="alert alert-primary fw-bold text-center fs-5">➡️ 연간 116시간 이상 업무 시간 절약! (약 97% 단축)</div>

    <!-- 비포/애프터 카드 -->
    <div class="before-after-container">
        <!-- BEFORE 카드 -->
        <div class="ba-card before">
            <div class="ba-card-title">
                <i class="fas fa-times-circle"></i> 자동화 이전
            </div>
            <div class="ba-icon">
                <i class="fas fa-user-clock"></i>
            </div>
            <div class="ba-content">
                <p><strong>📅 소요 시간:</strong></p>
                <p class="ba-highlight">연간 120시간 (교재당 40시간)</p>
                
                <p class="mt-3"><strong>👥 작업 방식:</strong></p>
                <ul>
                    <li>외주 인력이 교재 PDF 직접 확인</li>
                    <li>포토샵으로 문항 하나씩 수동 편집</li>
                    <li>이미지 파일로 하나씩 저장</li>
                    <li>최종 검수 과정 필요</li>
                </ul>
                
                <p class="mt-3"><strong>⚠️ 문제점:</strong></p>
                <ul>
                    <li>높은 인건비 발생</li>
                    <li>포토샵 라이선스 비용</li>
                    <li>휴먼 에러 가능성</li>
                    <li>작업 시간 예측 어려움</li>
                </ul>
            </div>
        </div>
        
        <!-- AFTER 카드 -->
        <div class="ba-card after">
            <div class="ba-card-title">
                <i class="fas fa-check-circle"></i> 자동화 이후
            </div>
            <div class="ba-icon">
                <i class="fas fa-robot"></i>
            </div>
            <div class="ba-content">
                <p><strong>⚡ 소요 시간:</strong></p>
                <p class="ba-highlight">연간 3~4시간</p>
                
                <p class="mt-3"><strong>🤖 작업 방식:</strong></p>
                <ul>
                    <li>Python 스크립트 자동 실행</li>
                    <li>PDF 자동 이미지 변환</li>
                    <li>문항 자동 분할/추출</li>
                    <li>순차적으로 자동 저장</li>
                    <li>최종 검수 불필요</li>
                </ul>
                
                <p class="mt-3"><strong>✅ 개선 효과:</strong></p>
                <ul>
                    <li><strong>연간 116시간 절약</strong></li>
                    <li>외주 인건비 절감</li>
                    <li>포토샵 라이선스 불필요</li>
                    <li>휴먼 에러 제거</li>
                    <li>일관된 품질 보장</li>
                </ul>
            </div>
        </div>
    </div>

    <h3 class="mt-5">2. 개발배경</h3>
    <p><strong>[ 업무 상황 ]</strong><br> 교재 문항 추출이 필요한 경우 외주 인력을 통해 사람이 직접 교재 PDF를 보고 포토샵을 활용해 문항 이미지를 하나씩 잘라서 저장하는 작업을 진행했습니다.</p>
    <p><strong>[ 비효율 ]</strong><br> 교재 한 권당 약 40시간이 소요되며, 포토샵 라이선스 비용과 외주 인건비가 발생했습니다. 또한 휴먼 에러 가능성이 있어 최종 검수 과정이 필수적이었습니다.</p>
    <p><strong>[ 확장 문제 ]</strong><br> 교재 출간 권수가 늘어날수록 외주 인력과 비용이 비례해서 증가하는 구조적 문제가 있었습니다.</p>

    <h3 class="mt-5">3. 개발과정</h3>
    <p><strong>[ Python을 통한 PDF 자동 추출 ]</strong></p>
    
    <h4 class="mt-4">자동화 프로세스 비교</h4>
    
    <div class="process-diagram-section">
        <div class="process-comparison-row">
            <!-- 자동화 이전 -->
            <div class="process-box">
                <div class="process-box-title">자동화 이전 프로세스(what)</div>
                <div class="process-icons-container">
                    <div class="process-icon-circle">
                        <i class="fas fa-user-tie"></i>
                    </div>
                    <div class="process-arrow">
                        <i class="fas fa-chevron-right"></i>
                    </div>
                    <div class="process-icon-circle">
                        <i class="fas fa-file-pdf"></i>
                    </div>
                    <div class="process-arrow">
                        <i class="fas fa-chevron-right"></i>
                    </div>
                    <div class="process-icon-circle">
                        <i class="fas fa-cut"></i>
                    </div>
                </div>
                <div class="process-labels">
                    <span class="process-label">외주인력 고용 및 포토샵 라이선스 결제</span>
                    <span class="process-label">교재 PDF 검수 및 작업 지시</span>
                    <span class="process-label">사람이 수기로 작업 문항 훑어보며 사이즈에 맞게 잘라내기 작업</span>
                </div>
                <div class="process-description">
                    <strong>소요 시간:</strong> 연간 120시간
                    <br>
                    외주 인력, 포토샵 라이선스 필요
                </div>
            </div>

            <!-- 자동화 이후 -->
            <div class="process-box">
                <div class="process-box-title">자동화 후 프로세스(how+if)</div>
                <div class="process-icons-container">
                    <div class="process-icon-circle simple">
                        <i class="fab fa-python"></i>
                    </div>
                </div>
                <div class="process-labels">
                    <span class="process-label simple">교재 PDF 지정 및 파이썬 실행</span>
                </div>
                <div class="process-description">
                    <strong>소요 시간:</strong> 연간 3~4시간
                    <br>
                    <strong style="color: #2ecc71;">기타 알파틱: 전 120시간 → 후 3~4시간 및 포토샵 라이선스 비용 절약</strong>
                </div>
            </div>
        </div>
    </div>

    <h3 class="mt-5">4. 개발 이슈 및 해결</h3>
    
    <div class="row">
        <!-- 이슈 1 -->
        <div class="col-12 mb-3">
            <div class="card border-warning">
                <div class="card-header bg-warning bg-opacity-10">
                    <h5 class="mb-0"><i class="fas fa-exclamation-triangle text-warning me-2"></i>시각적 요소 설명의 한계</h5>
                </div>
                <div class="card-body">
                    <p class="mb-2"><strong>🔴 내용:</strong></p>
                    <p class="ms-3 mb-3">2단 구성으로 된 문항을 문항 번호 기준으로 분할하거나 병합하는 방식 등 시각적 요소에 대한 설명이 어려움.</p>
                    
                    <p class="mb-2"><strong>✅ 해결 방안:</strong></p>
                    <p class="ms-3 mb-0">처리 단계를 세분화하여 설계. 세로선을 기준으로 이미지를 좌우로 분할한 후, 세로 방향으로 이어 붙이는 방식을 적용하여 2단 구성의 한계를 극복함.</p>
                </div>
            </div>
        </div>

        <!-- 이슈 2 -->
        <div class="col-12 mb-3">
            <div class="card border-warning">
                <div class="card-header bg-warning bg-opacity-10">
                    <h5 class="mb-0"><i class="fas fa-exclamation-triangle text-warning me-2"></i>문자 인식 정확도 문제</h5>
                </div>
                <div class="card-body">
                    <p class="mb-2"><strong>🔴 내용:</strong></p>
                    <p class="ms-3 mb-3">OCR(광학 문자 인식)을 활용해 문항 번호를 읽고 이미지를 추출할 때 제대로 처리되지 않는 오류 발생.</p>
                    
                    <p class="mb-2"><strong>✅ 해결 방안:</strong></p>
                    <p class="ms-3 mb-0">문항 번호 패턴을 검증하는 추가 로직을 적용하여 잘못 인식된 경우 예외 처리되도록 설계하고, 필요 시 수동 검증 절차를 도입하여 오류 최소화.</p>
                </div>
            </div>
        </div>

        <!-- 이슈 3 -->
        <div class="col-12 mb-3">
            <div class="card border-warning">
                <div class="card-header bg-warning bg-opacity-10">
                    <h5 class="mb-0"><i class="fas fa-exclamation-triangle text-warning me-2"></i>시스템 처리 한계</h5>
                </div>
                <div class="card-body">
                    <p class="mb-2"><strong>🔴 내용:</strong></p>
                    <p class="ms-3 mb-3">모든 작업을 한 번에 처리하려다 보니 리소스 초과로 프로그램이 멈추는 문제 발생.</p>
                    
                    <p class="mb-2"><strong>✅ 해결 방안:</strong></p>
                    <p class="ms-3 mb-0">전체 코드를 한 번에 실행하는 대신, 페이지별로 분할하여 단계적으로 처리하도록 시스템을 개선.</p>
                </div>
            </div>
        </div>
    </div>

    <h3 class="mt-5">5. 도입 성과 상세</h3>
    <p>이번 자동화를 통해 교재 문항 추출 업무를 획기적으로 개선했습니다.</p>
    
    <h5 class="mt-4">업무 시간 비교</h5>
    <ul class="list-unstyled">
        <li><i class="fas fa-minus-circle text-danger me-2"></i> <strong>기존 (수작업):</strong> 연간 120시간 소요 (외주인력 1명, 교재당 40시간)</li>
        <li><i class="fas fa-check-circle text-success me-2"></i> <strong>개선 (자동화):</strong> 연간 3~4시간 소요</li>
    </ul>

    <h5 class="mt-4">추가 개선 효과</h5>
    <ul class="list-unstyled">
        <li><i class="fas fa-check-circle text-success me-2"></i>외주 인건비 절감</li>
        <li><i class="fas fa-check-circle text-success me-2"></i>포토샵 라이선스 비용 절감</li>
        <li><i class="fas fa-check-circle text-success me-2"></i>최종 검수 기간 불필요</li>
        <li><i class="fas fa-check-circle text-success me-2"></i>휴먼 에러 가능성 제거</li>
        <li><i class="fas fa-check-circle text-success me-2"></i>일관된 품질의 이미지 추출</li>
    </ul>

    <h3 class="mt-5">6. 첨부파일</h3>
    <p>아래 링크를 클릭하여 자동화 관련 파일을 다운로드할 수 있습니다.</p>
    
    <ul class="list-unstyled">
        <li class="mb-2">
            <i class="fas fa-download me-2 text-primary"></i>
            <a href="assets/files/python_발표자료.pdf" download="python_발표자료.pdf">
                첨부파일 1 (발표자료)
            </a>
        </li>
        <li class="mb-2">
            <i class="fas fa-download me-2 text-primary"></i>
            <a href="assets/files/python_시연영상.mp4" download="python_시연영상.mp4">
                첨부파일 2 (시연영상)
            </a>
        </li>
    </ul>

</div>
